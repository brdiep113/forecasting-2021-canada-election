---
title: "Modelling"
author: "Eric Zhu, Brian Diep, Tanvir Hyder, Ashley Zhang, Kristin Huang"
date: "09/19/2021"
output:
  pdf_document: 
    toc: yes
    toc_depth: 3
    extra_dependencies: ["float"]
header-includes:
- \usepackage{fancyhdr}
- \usepackage[T1]{fontenc}
- \usepackage{lmodern}
- \usepackage{bm}
- \usepackage[ruled,vlined]{algorithm2e}
- \usepackage{setspace}
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \usepackage{float}
- \floatplacement{figure}{H}
- \fancyhead[LO,LE]{Eric Zhu, Brian Diep, Tanvir Hyder, Ashley Zhang, Kristin Huang}
---

```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(brms)
library(lme4)

predictors_df <- read_csv("predictors_dataframe.csv")

```

```{r}
model <- nnet::multinom(votechoice ~ education + cps19_income_cat + own_residence + language + ethnicity + cps19_bornin_canada , data = predictors_df)
broom::tidy(model)
#summary(model)
```

```{r}
library(caret)
predictors_df$votechoice <- as.factor(predictors_df$votechoice)

pred <- predict(model)
pred2 <- as.data.frame(pred) %>% 
  mutate(actual = as.character(predictors_df$votechoice),
         pred   = colnames(pred)[max.col(pred,ties.method="first")],
         pred   = str_remove(pred,"P\\(Y = "),
         pred   = str_remove(pred,"\\)"),
         actual = factor(actual),
         pred   = factor(pred))



confusionMatrix(pred2$pred, pred2$p)
```
